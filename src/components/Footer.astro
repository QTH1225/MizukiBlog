---

import fs from "node:fs";
import path from "node:path";
import { footerConfig, profileConfig } from "../config";
import { navigateToPage } from "../utils/navigation-utils";
import { url } from "../utils/url-utils";

const currentYear = new Date().getFullYear();

// 计算网站运行时间（天、小时、分钟、秒）
const calculateSiteRunningTime = () => {
  // 假设网站从2025年9月12日开始运行，您可以根据实际情况修改这个日期
  const siteStartDate = new Date("2025-09-12");
  const currentDate = new Date();
  const timeDiff = currentDate.getTime() - siteStartDate.getTime();
  
  const days = Math.floor(timeDiff / (1000 * 3600 * 24));
  const hours = Math.floor((timeDiff % (1000 * 3600 * 24)) / (1000 * 3600));
  const minutes = Math.floor((timeDiff % (1000 * 3600)) / (1000 * 60));
  const seconds = Math.floor((timeDiff % (1000 * 60)) / 1000);
  
  return { days, hours, minutes, seconds };
};

const siteRunningTime = calculateSiteRunningTime();

// 读取FooterConfig.html文件内容
let customFooterHtml = "";
if (footerConfig.enable) {
	try {
		const footerConfigPath = path.join(
			process.cwd(),
			"src",
			"FooterConfig.html",
		);
		customFooterHtml = fs.readFileSync(footerConfigPath, "utf-8");
		// 移除HTML注释
		customFooterHtml = customFooterHtml.replace(/<!--[\s\S]*?-->/g, "").trim();
	} catch (error) {
		console.warn("FooterConfig.html文件读取失败:", error.message);
	}
}
---

<!--<div class="border-t border-[var(&#45;&#45;primary)] mx-16 border-dashed py-8 max-w-[var(&#45;&#45;page-width)] flex flex-col items-center justify-center px-6">-->
<div class="transition border-t border-black/10 dark:border-white/15 my-10 border-dashed mx-8 md:mx-16 lg:mx-32"></div>
<!--<div class="transition bg-[oklch(92%_0.01_var(&#45;&#45;hue))] dark:bg-black rounded-2xl py-8 mt-4 mb-8 flex flex-col items-center justify-center px-6">-->
<div class="transition border-dashed border-[oklch(85%_0.01_var(--hue))] dark:border-white/15 rounded-2xl mb-12 flex flex-col items-center justify-center px-4 md:px-6">
    <div class="transition text-50 text-sm text-center">
        {customFooterHtml && (
            <div class="mb-2" set:html={customFooterHtml}></div>
        )}
        &copy; <span id="copyright-year">{currentYear}</span> {profileConfig.name}. All Rights Reserved. /
        <span id="site-running-time" class="text-[var(--primary)] font-medium text-xs md:text-sm">Blog running for {siteRunningTime.days} days {siteRunningTime.hours} hours {siteRunningTime.minutes} minutes {siteRunningTime.seconds} seconds</span> /
        <a class="transition link text-[var(--primary)] font-medium" target="_blank" href={url('rss/')}>RSS</a> /
        <a class="transition link text-[var(--primary)] font-medium" target="_blank" href={url('sitemap-index.xml')}>Sitemap</a><br>
        Powered by
        <a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://astro.build">Astro</a> &
        <a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://github.com/matsuzaka-yuki/mizuki">Mizuki</a>&nbsp; Version <a class="transition link text-[var(--primary)] font-medium" target="_blank" href="https://github.com/matsuzaka-yuki/mizuki">5.2</a><br>
        

    </div>
</div>

<script>
// 实时更新网站运行时间
(function() {
  // 网站开始运行的日期
  const siteStartDate = new Date("2025-09-12");
  
  function updateRunningTime() {
    const timeElement = document.getElementById('site-running-time');
    if (!timeElement) return;
    
    // 计算当前时间与开始时间的差值
    const currentTime = new Date();
    const timeDiff = currentTime.getTime() - siteStartDate.getTime();
    
    // 计算天、小时、分钟、秒
    const days = Math.floor(timeDiff / (1000 * 3600 * 24));
    const hours = Math.floor((timeDiff % (1000 * 3600 * 24)) / (1000 * 3600));
    const minutes = Math.floor((timeDiff % (1000 * 3600)) / (1000 * 60));
    const seconds = Math.floor((timeDiff % (1000 * 60)) / 1000);
    
    // 更新显示内容
    timeElement.textContent = `Blog running for ${days} days ${hours} hours ${minutes} minutes ${seconds} seconds`;
  }
  
  // 页面加载后立即更新一次
  if (typeof document !== 'undefined') {
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', function() {
        updateRunningTime();
        // 每秒更新一次
        setInterval(updateRunningTime, 1000);
      });
    } else {
      updateRunningTime();
      // 每秒更新一次
      setInterval(updateRunningTime, 1000);
    }
  }
})();
</script>